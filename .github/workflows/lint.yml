name: JavaScript Linting (ESLint)

# Define cuándo se ejecuta el workflow
on:
  push:
    branches:
      # Ramas principales que deben estar protegidas
      - main
      - master
      - develop
  pull_request:
    branches:
      - main
      - master
      - develop

jobs:
  lint:
    runs-on: ubuntu-latest # Ejecutar en un servidor Linux

    steps:
      # 1. Checkout: Descargar el código del repositorio
      - name: Checkout Repository
        uses: actions/checkout@v4

      # 2. Setup Node.js: Configurar el entorno de Node.js (necesario para NPM/ESLint)
      - name: Use Node.js 20.x
        uses: actions/setup-node@v4
        with:
          node-version: '20.x'

      # 3. Instalación de ESLint y Dependencias de forma Global (Temporal)
      # ¡PASO CLAVE! Esto instala todas las reglas que .eslintrc.js necesita.
      - name: Install ESLint and Required Configs Globally
        run: |
          # Instalamos todos los paquetes requeridos, incluyendo plugins de AirBnB y Prettier.
          # Esto sucede solo en el servidor de GitHub, fuera del entorno local del alumno.
          npm install -g \
            eslint@8 \
            eslint-config-airbnb-base \
            eslint-plugin-import \
            eslint-config-prettier \
            prettier

      # 4. Ejecutar ESLint Check
      - name: Run ESLint Check
        # Usamos el binario de eslint que ahora está disponible globalmente en el contenedor.
        # El comando 'eslint' detectará automáticamente los archivos .eslintrc.js y .prettierrc
        # --max-warnings 0 asegura que falle con cualquier advertencia o error, forzando la limpieza.
        run: |
          eslint . --ext .js --max-warnings 0
